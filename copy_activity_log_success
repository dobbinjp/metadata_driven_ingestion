SELECT '@{pipeline().DataFactory}' as DataFactory_Name,
'@{pipeline().Pipeline}' as Pipeline_Name,
'@{pipeline().RunId}' as RunId,
'MDS_To_DataLake' as SourceToTargetType,
'@{item().SourceExtractMethod}' as SourceExtractMethod,
'@{item().SourceServerName}' as SourceServerName,
'@{item().SourceDatabaseName}' as SourceDatabaseName,
'@{item().SourceSchemaName}' as SourceSchemaName,
'@{item().SourceTableName}' as SourceTableName,
'@{item().DataLakeContainer}' as TargetDataLakeContainerName,
'@{item().DataLakeFolder}' as TargetDirectoryName,
'@{concat(item().DataLakeFile,'.parquet')}' as TargetFileName,
'@{pipeline().TriggerType}' as TriggerType,
'@{pipeline().TriggerId}' as TriggerId,
'@{pipeline().TriggerName}' as TriggerName,
'@{convertFromUtc(pipeline().TriggerTime,'Central Standard Time')}' as TriggerTimeUTC,
'@{activity('Copy Source to ADLS SQL').output.rowsCopied}' as RowsCopied,
'@{activity('Copy Source to ADLS SQL').output.rowsRead}' as RowsRead,
'@{activity('Copy Source to ADLS SQL').output.usedParallelCopies}' as No_ParallelCopies,
'@{activity('Copy Source to ADLS SQL').output.copyDuration}' as copyDuration_in_secs,
'@{activity('Copy Source to ADLS SQL').output.effectiveIntegrationRuntime}' as effectiveIntegrationRuntime,
'@{activity('Copy Source to ADLS SQL').output.executionDetails[0].source}' as Source_Type,
'@{activity('Copy Source to ADLS SQL').output.executionDetails[0].sink}' as Sink_Type,
'@{activity('Copy Source to ADLS SQL').output.executionDetails[0].status}' as Execution_Status,
'@{convertFromUtc(activity('Copy Source to ADLS SQL').output.executionDetails[0].start,'Central Standard Time')}' as CopyActivity_Start_Time_UTC,
'@{convertFromUtc(utcNow(),'Central Standard Time')}' as CopyActivity_End_Time_UTC,
'@{activity('Copy Source to ADLS SQL').output.executionDetails[0].detailedDurations.queuingDuration}' as CopyActivity_queuingDuration_in_secs,
'@{activity('Copy Source to ADLS SQL').output.executionDetails[0].detailedDurations.timeToFirstByte}' as CopyActivity_preCopyScriptDuration_in_secs,
'@{activity('Copy Source to ADLS SQL').output.executionDetails[0].detailedDurations.transferDuration}' as CopyActivity_transferDuration_in_secs,
null as ErrorMessage
